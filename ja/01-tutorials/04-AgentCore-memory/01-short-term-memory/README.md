# AgentCore Memory: 短期メモリ

## 概要

Amazon Bedrock AgentCore の短期メモリは、即時の会話コンテキストとセッションベースの情報管理を提供します。AI エージェントが単一のインタラクションまたは密接に関連するセッション内で継続性を維持し、会話全体を通じて一貫性のあるコンテキストを認識した応答を確保できるようにします。

## 短期メモリとは？

短期メモリは以下に焦点を当てています：

- **セッションの継続性**: 単一の会話セッション内でのコンテキストの維持
- **即時コンテキスト**: 一貫性のある応答のための最近の会話履歴の保持
- **一時的な状態**: 現在のインタラクションに関連する一時的な情報の管理
- **会話フロー**: セッション内のトピック間のスムーズな遷移の確保

## AgentCore での短期メモリの仕組み

### イベントストレージ

AgentCore Memory は完全な会話イベントを生の形式で保存し、以下への即時アクセスを提供します：

- 最後の `k` 件のユーザーメッセージとエージェントの応答
- 会話メタデータ（タイムスタンプ、セッション ID、アクター ID）
- 複雑なインタラクションのための分岐会話パス

### セッション管理

短期メモリはセッションレベルで動作します：

- 各会話セッションは独自のコンテキストを維持
- 関連するセッションはセッショングループ化を通じてコンテキストを共有可能
- 期限切れのセッションデータの自動クリーンアップ（設定された TTL に基づく）

### リアルタイムアクセス

バックグラウンドで処理される長期メモリ戦略とは異なり、短期メモリは以下を提供します：

- 最近の会話履歴の即時取得
- セッションが中断したりエージェントが失敗した場合の会話継続
- 会話の進行に伴うリアルタイムのコンテキスト更新
- セッション固有の情報への低レイテンシアクセス

## ベストプラクティス

1. **コンテキストウィンドウ管理**: オーバーフローを防ぐためにコンテキスト使用量を監視
2. **セッション境界**: セッションの開始と終了を明確に定義
3. **メモリクリーンアップ**: 期限切れセッションに対する適切なクリーンアップポリシーを実装
4. **エラー処理**: メモリ取得の失敗を適切に処理
5. **パフォーマンス最適化**: 大規模な会話履歴に対して効率的なクエリパターンを使用（例：長期の要約戦略経由）

## フレームワークとの統合

短期メモリは人気のあるエージェントフレームワークとシームレスに統合されます：

- **Strands Agent**: 会話フックとのネイティブ統合
- **LangGraph**: 状態管理統合
- **カスタムフレームワーク**: 柔軟な実装のための直接 API アクセス

## 利用可能なサンプルノートブック

これらのハンズオン例を探索して、短期メモリの実装を学びましょう：

| フレームワーク  | ユースケース      | 説明                                                                                       | ノートブック                                                                                                               | アーキテクチャ                                                         |
| --------------- | ----------------- | ------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- |
| Strands Agent   | パーソナルエージェント | セッション内で会話コンテキストを維持し、ユーザーインタラクションを記憶する AI アシスタント | [personal-agent.ipynb](./01-single-agent/with-strands-agent/personal-agent.ipynb)                                          | [表示](./01-single-agent/with-strands-agent/architecture.png)          |
| LangGraph       | フィットネスコーチ | トレーニングセッション全体を通じてワークアウトの進捗を追跡し、コンテキストを維持するパーソナルフィットネスコーチ | [personal-fitness-coach.ipynb](./01-single-agent/with-langgraph-agent/personal-fitness-coach.ipynb)                        | [表示](./01-single-agent/with-langgraph-agent/images/architecture.png) |
| LangGraph       | サポートエージェント | 複雑な問題解決のための人間参加型機能を備えたカスタマーサポートエージェント                 | [support-agent-human-in-the-loop.ipynb](./01-single-agent/with-langgraph-agent/support-agent-human-in-the-loop.ipynb)      | [表示](./01-single-agent/with-langgraph-agent/images/architecture.png) |
| LangGraph       | 数学エージェント  | 複雑な計算のためのマルチステップ永続化機能を備えた数学問題解決エージェント                 | [math-agent-with-multi-step-persistence.ipynb](./01-single-agent/with-langgraph-agent/math-agent-with-checkpointing.ipynb) | [表示](./01-single-agent/with-langgraph-agent/images/architecture.png) |
| Strands Agent   | 旅行計画          | 複雑な旅行スケジュールを計画しながらコンテキストを共有する協調エージェント                 | [travel-planning-agent.ipynb](./02-multi-agent/with-strands-agent/travel-planning-agent.ipynb)                             | [表示](./02-multi-agent/with-strands-agent/architecture.png)           |

## 始め方

1. ユースケースに合ったサンプルを選択
2. サンプルフォルダに移動
3. 要件をインストール: `pip install -r requirements.txt`
4. Jupyter ノートブックを開き、ステップバイステップの実装に従う

## 次のステップ

短期メモリに慣れたら、[長期メモリ](../02-long-term-memory/)を探索して、複数の会話やセッションにわたって機能する永続的なメモリ戦略について学びましょう。
